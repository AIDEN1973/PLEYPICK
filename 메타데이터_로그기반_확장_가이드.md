# ğŸ“‹ ë¡œê·¸ ê¸°ë°˜ ì¹´í…Œê³ ë¦¬ í™•ì¥ ê°€ì´ë“œ

**ì „ëµ**: ê³ ì • 30ê°œ ì¹´í…Œê³ ë¦¬ + ë¶„ê¸°ë³„ ë¡œê·¸ ë¶„ì„ í™•ì¥  
**ëª©ì **: íì‡„í™˜ê²½ ì‹¤ì‹œê°„ ê²€ì¶œ ì„±ëŠ¥ ìœ ì§€ + ìœ ì—°í•œ í™•ì¥  
**ì‘ì„±ì¼**: 2025-10-13

---

## ğŸ¯ ì‹œìŠ¤í…œ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ì‹¤ì‹œê°„ ê²€ì¶œ (ê³ ì • 30ê°œ ì¹´í…Œê³ ë¦¬)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  YOLO ê²€ì¶œ â†’ LLM ë¶„ì„ â†’ shape_tag â†’ part_category       â”‚
â”‚                            â†“                              â”‚
â”‚                      unknown(99)? â†’ ë¡œê·¸ ìˆ˜ì§‘            â”‚
â”‚                                       â†“                   â”‚
â”‚                            unknown_category_logs         â”‚
â”‚                                       â†“                   â”‚
â”‚                              ë¶„ê¸° 1íšŒ ë¶„ì„               â”‚
â”‚                                       â†“                   â”‚
â”‚                          HIGH priority ë°œê²¬?             â”‚
â”‚                                â†“                          â”‚
â”‚                   SQL INSERT â†’ ìƒˆ ì¹´í…Œê³ ë¦¬ ì¶”ê°€          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ ì„¤ì¹˜ (3ë‹¨ê³„)

### Step 1: ê¸°ë³¸ ì¹´í…Œê³ ë¦¬ ì‹œìŠ¤í…œ
```bash
# ê³ ì • 30ê°œ ì¹´í…Œê³ ë¦¬ ìƒì„±
psql -f database/create_part_categories_table.sql
psql -f database/fix_part_category_constraint.sql
psql -f database/migrate_part_categories.sql
```

### Step 2: ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ
```bash
# unknown ë¡œê·¸ ìˆ˜ì§‘ ì‹œìŠ¤í…œ
psql -f database/create_category_monitoring.sql
```

### Step 3: ì½”ë“œ ë°°í¬
```bash
# ìˆ˜ì •ëœ ì½”ë“œ ë°°í¬ (ë¡œê·¸ ìˆ˜ì§‘ í¬í•¨)
npm run build
# ë˜ëŠ” git push
```

---

## ğŸ” ì¼ìƒ ìš´ì˜ (ìë™)

### ë¡œê·¸ ìˆ˜ì§‘ (ìë™)
```javascript
// getPartCategoryCodeSync í˜¸ì¶œ ì‹œ ìë™ ë¡œê·¸
shape_tag: 'unknown_shape_xyz'
  â†“
ì½˜ì†” ë¡œê·¸: [UNKNOWN_CATEGORY] {"shape_tag": "unknown_shape_xyz", ...}
  â†“
DB ë¡œê·¸: unknown_category_logs í…Œì´ë¸” INSERT (ì˜¨ë¼ì¸ ì‹œ)
```

### í™•ì¸ ë°©ë²•
```sql
-- ìµœê·¼ unknown ê²€ì¶œ í™•ì¸
SELECT * FROM v_unknown_categories_summary;

-- ì˜¤ëŠ˜ ê²€ì¶œëœ unknown ë¶€í’ˆ
SELECT * FROM v_unknown_parts_detail 
WHERE DATE(last_detected_at) = CURRENT_DATE;
```

---

## ğŸ“Š ë¶„ê¸°ë³„ ê²€í†  (3ê°œì›”ë§ˆë‹¤)

### 1. ë¦¬í¬íŠ¸ ì‹¤í–‰
```bash
# ìë™ ë¦¬í¬íŠ¸ ìƒì„±
./scripts/quarterly_category_review.sh

# ë˜ëŠ” ìˆ˜ë™ SQL
psql -c "SELECT * FROM generate_category_review_report();"
```

### 2. ê²°ê³¼ ë¶„ì„
```
ğŸ“Š ë¶„ê¸°ë³„ ì¹´í…Œê³ ë¦¬ ê²€í†  ë¦¬í¬íŠ¸
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

shape_tag        | parts | detections | recommendation
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
connector        | 15    | 245        | ğŸ”´ HIGH: ì¦‰ì‹œ ì¶”ê°€
hinge_plate      | 8     | 87         | ğŸŸ¡ MEDIUM: ê²€í† 
bracket          | 5     | 23         | ğŸŸ¢ LOW: ëª¨ë‹ˆí„°ë§
```

### 3. ì¹´í…Œê³ ë¦¬ ì¶”ê°€ (HIGH priorityë§Œ)
```sql
-- ì˜ˆì‹œ: connector ì¶”ê°€

-- 1. ë‹¤ìŒ ID í™•ì¸
SELECT MAX(id) + 1 FROM part_categories WHERE id < 99;
-- ê²°ê³¼: 30

-- 2. ì¹´í…Œê³ ë¦¬ ì¶”ê°€
INSERT INTO part_categories (id, code, display_name, display_name_ko, category_type, sort_order)
VALUES (30, 'connector', 'Connector', 'ì»¤ë„¥í„°', 'shape', 30);

-- 3. ê¸°ì¡´ ë¶€í’ˆ ë§ˆì´ê·¸ë ˆì´ì…˜
UPDATE parts_master_features
SET part_category = 30, shape_tag = 'connector'
WHERE shape_tag = 'unknown' 
  AND LOWER(part_name) LIKE '%connector%';

-- 4. ë¡œê·¸ ì •ë¦¬
SELECT cleanup_resolved_category_logs('connector');
```

### 4. ì• í”Œë¦¬ì¼€ì´ì…˜ ì—…ë°ì´íŠ¸
```javascript
// src/composables/useMasterPartsPreprocessing.js
// getHardcodedCategoryMapping() í•¨ìˆ˜ì— ì¶”ê°€

function getHardcodedCategoryMapping() {
  return {
    // ... ê¸°ì¡´ ì¹´í…Œê³ ë¦¬ ...
    'connector': 30,  // âœ… ìƒˆë¡œ ì¶”ê°€
    'unknown': 99
  };
}
```

### 5. ë°°í¬
```bash
# íì‡„í™˜ê²½ DB ì—…ë°ì´íŠ¸
# Option A: SQL íŒŒì¼ ì‹¤í–‰ (USB ë“±)
psql -f add_connector_category.sql

# Option B: ë„¤íŠ¸ì›Œí¬ ë™ê¸°í™”
# rsync ë˜ëŠ” ìˆ˜ë™ ë³µì‚¬

# ì• í”Œë¦¬ì¼€ì´ì…˜ ì¬ë°°í¬
npm run build
# ë˜ëŠ” ì„œë¹„ìŠ¤ ì¬ì‹œì‘
```

---

## ğŸ“ˆ ëª¨ë‹ˆí„°ë§ ì¿¼ë¦¬

### ì¼ì¼ ì²´í¬
```sql
-- ì˜¤ëŠ˜ unknown ê²€ì¶œ ìˆ˜
SELECT COUNT(*) FROM unknown_category_logs 
WHERE DATE(last_detected_at) = CURRENT_DATE;

-- ìµœê·¼ 7ì¼ íŠ¸ë Œë“œ
SELECT 
  DATE(last_detected_at) as date,
  COUNT(DISTINCT part_id) as parts,
  SUM(detected_count) as detections
FROM unknown_category_logs
WHERE last_detected_at >= NOW() - INTERVAL '7 days'
GROUP BY DATE(last_detected_at)
ORDER BY date DESC;
```

### ì£¼ê°„ ë¦¬í¬íŠ¸
```sql
-- ì´ë²ˆ ì£¼ TOP 10 unknown
SELECT 
  shape_tag,
  COUNT(DISTINCT part_id) as parts,
  SUM(detected_count) as detections
FROM unknown_category_logs
WHERE last_detected_at >= DATE_TRUNC('week', NOW())
GROUP BY shape_tag
ORDER BY detections DESC
LIMIT 10;
```

### ì›”ê°„ ë¦¬í¬íŠ¸
```sql
-- ì´ë²ˆ ë‹¬ ìš”ì•½
SELECT 
  COUNT(DISTINCT shape_tag) as unique_shapes,
  COUNT(DISTINCT part_id) as unique_parts,
  SUM(detected_count) as total_detections
FROM unknown_category_logs
WHERE last_detected_at >= DATE_TRUNC('month', NOW());
```

---

## ğŸ”§ ë¬¸ì œ í•´ê²°

### unknown ë¡œê·¸ê°€ ìŒ“ì´ì§€ ì•ŠìŒ
```bash
# 1. í…Œì´ë¸” ì¡´ì¬ í™•ì¸
psql -c "\d unknown_category_logs"

# 2. RPC í•¨ìˆ˜ í™•ì¸
psql -c "\df log_unknown_category"

# 3. ì½˜ì†” ë¡œê·¸ í™•ì¸
# ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸ì—ì„œ [UNKNOWN_CATEGORY] ê²€ìƒ‰
```

### ë¡œê·¸ê°€ ë„ˆë¬´ ë§ì´ ìŒ“ì„
```sql
-- ì˜¤ë˜ëœ ë¡œê·¸ ì •ë¦¬ (6ê°œì›” ì´ìƒ)
DELETE FROM unknown_category_logs 
WHERE first_detected_at < NOW() - INTERVAL '6 months'
  AND detected_count < 5;

-- ë˜ëŠ” ì•„ì¹´ì´ë¸Œ
CREATE TABLE unknown_category_logs_archive AS
SELECT * FROM unknown_category_logs
WHERE first_detected_at < NOW() - INTERVAL '6 months';

DELETE FROM unknown_category_logs 
WHERE first_detected_at < NOW() - INTERVAL '6 months';
```

### ì¹´í…Œê³ ë¦¬ ì¶”ê°€ í›„ ì ìš© ì•ˆë¨
```javascript
// ìºì‹œ ê°•ì œ ê°±ì‹ 
categoryMappingCache = null;
await loadCategoryMapping(true);  // forceRefresh=true
```

---

## ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì„¤ì¹˜ ì‹œ
- [ ] create_part_categories_table.sql ì‹¤í–‰
- [ ] fix_part_category_constraint.sql ì‹¤í–‰
- [ ] migrate_part_categories.sql ì‹¤í–‰
- [ ] create_category_monitoring.sql ì‹¤í–‰
- [ ] ì½”ë“œ ë°°í¬ (ë¡œê·¸ ìˆ˜ì§‘ í¬í•¨)
- [ ] quarterly_category_review.sh ì‹¤í–‰ ê¶Œí•œ ì„¤ì •

### ë¶„ê¸°ë³„
- [ ] ë¦¬í¬íŠ¸ ì‹¤í–‰
- [ ] HIGH priority ê²€í† 
- [ ] í•„ìš”í•œ ì¹´í…Œê³ ë¦¬ ì¶”ê°€
- [ ] ì½”ë“œ ì—…ë°ì´íŠ¸
- [ ] ë°°í¬ ë° í…ŒìŠ¤íŠ¸
- [ ] ë¡œê·¸ ì •ë¦¬

---

## ğŸ¯ ì˜ˆìƒ ìš´ì˜

### ì²« í•´
- ë¶„ê¸° 1: 5ê°œ ì¶”ê°€ (30 â†’ 35)
- ë¶„ê¸° 2: 3ê°œ ì¶”ê°€ (35 â†’ 38)
- ë¶„ê¸° 3: 2ê°œ ì¶”ê°€ (38 â†’ 40)
- ë¶„ê¸° 4: 1ê°œ ì¶”ê°€ (40 â†’ 41)

### ì´í›„
- ì—°ê°„ 2-3ê°œ ì¶”ê°€
- 5ë…„ í›„: ì•½ 50ê°œ ì¹´í…Œê³ ë¦¬
- 99ê°œ í•œë„ê¹Œì§€ ì¶©ë¶„í•œ ì—¬ìœ 

---

## âœ… ì¥ì  ìš”ì•½

### ì„±ëŠ¥
- âœ… ê²€ì¶œ ì†ë„: 0.001ms (ê³ ì • ë§¤í•‘)
- âœ… ì‹¤ì‹œê°„ ì„±ëŠ¥ ìœ ì§€
- âœ… íì‡„í™˜ê²½ ì™„ë²½ ì§€ì›

### í’ˆì§ˆ
- âœ… ìˆ˜ë™ ê²€ì¦ìœ¼ë¡œ ì •í™•ë„ ë³´ì¥
- âœ… ë…¸ì´ì¦ˆ ì¹´í…Œê³ ë¦¬ ë°©ì§€
- âœ… ì œì–´ëœ í™•ì¥

### ìš´ì˜
- âœ… ë¶„ê¸° 30ë¶„ ì‘ì—…
- âœ… ë‚®ì€ ë³µì¡ë„
- âœ… ì•ˆì •ì  ìš´ì˜

---

**ê²°ë¡ **: íì‡„í™˜ê²½ + ì‹¤ì‹œê°„ ê²€ì¶œì— ìµœì í™”ëœ ì „ëµ! ğŸš€

