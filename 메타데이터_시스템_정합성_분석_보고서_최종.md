# ğŸ” ë¸Œë¦­ë°•ìŠ¤ ë©”íƒ€ë°ì´í„° ì‹œìŠ¤í…œ ì •í•©ì„± ë¶„ì„ ìµœì¢… ë³´ê³ ì„œ

**ì‘ì„±ì¼**: 2025-10-13  
**ë¶„ì„ ë²”ìœ„**: ì „ì²´ ì›Œí¬í”Œë¡œìš° (UI â†’ DB â†’ AI â†’ ë Œë”ë§ â†’ ë¹„ì „ ê²€ì¶œ)  
**ë¶„ì„ì**: AI Assistant (Claude Sonnet 4.5)

---

## ğŸ“‹ ëª©ì°¨

1. [ë¶„ì„ ê°œìš”](#1-ë¶„ì„-ê°œìš”)
2. [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ë§µ](#2-ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜-ë§µ)
3. [ìˆœì°¨ ì •í•©ì„± ë¶„ì„](#3-ìˆœì°¨-ì •í•©ì„±-ë¶„ì„)
4. [ë°œê²¬ëœ ë¬¸ì œì ](#4-ë°œê²¬ëœ-ë¬¸ì œì )
5. [ê¸°ìˆ ë¬¸ì„œ vs ì‹¤ì œ êµ¬í˜„ ë¹„êµ](#5-ê¸°ìˆ ë¬¸ì„œ-vs-ì‹¤ì œ-êµ¬í˜„-ë¹„êµ)
6. [ê¶Œì¥ ê°œì„ ì‚¬í•­](#6-ê¶Œì¥-ê°œì„ ì‚¬í•­)
7. [ìµœì¢… ê²°ë¡ ](#7-ìµœì¢…-ê²°ë¡ )

---

## 1. ë¶„ì„ ê°œìš”

### 1.1 ë¶„ì„ ëŒ€ìƒ

#### UI í˜ì´ì§€ (2ê°œ)
- âœ… `/new-lego` (`NewLegoRegistration.vue` - 2273ì¤„)
- âœ… `/saved-lego` (`SavedLegoManager.vue` - 1863ì¤„)

#### ë©”íƒ€ë°ì´í„° ê´€ë¦¬ íƒ­ (4ê°œ)
- âœ… ğŸ“ AI ë©”íƒ€ë°ì´í„° íƒ­ (`MetadataTab.vue`)
- âœ… ğŸ§  CLIP ì„ë² ë”© íƒ­ (`EmbeddingTab.vue`)
- âœ… ğŸ”§ í”„ë¡¬í”„íŠ¸ ì„¤ì • íƒ­ (`PromptConfigTab.vue`)
- âœ… ğŸ“Š ì¹´í…Œê³ ë¦¬ ëª¨ë‹ˆí„°ë§ íƒ­ (`CategoryMonitoringTab.vue`)

#### ê¸°ìˆ ë¬¸ì„œ ì •í•©ì„±
- âœ… ë Œë”ë§ (Blender)
- âœ… ì–´ë…¸í…Œì´ì…˜ (YOLO)
- âœ… JSON (ë©”íƒ€ë°ì´í„°)
- âœ… ê²€ì¶œ ë¹„ì „ (ì‹¤ì‹œê°„)

---

## 2. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ë§µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ğŸ§± ë¸Œë¦­ë°•ìŠ¤ ë©”íƒ€ë°ì´í„° ì‹œìŠ¤í…œ                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1ï¸âƒ£ ë°ì´í„° ìˆ˜ì§‘  â”‚  â†’   â”‚  2ï¸âƒ£ AI ë©”íƒ€ë°ì´í„°  â”‚  â†’   â”‚ 3ï¸âƒ£ í•©ì„± ë Œë”ë§  â”‚
â”‚  (Rebrickable) â”‚      â”‚     ìƒì„± (LLM)    â”‚      â”‚   (Blender)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“                        â†“                         â†“
  â€¢ ì„¸íŠ¸ ì •ë³´             â€¢ ë¶€í’ˆ íŠ¹ì§• ë¶„ì„          â€¢ 200ì¥/ë¶€í’ˆ
  â€¢ ë¶€í’ˆ ëª©ë¡             â€¢ CLIP ì„ë² ë”©             â€¢ WebP (q=90)
  â€¢ ì´ë¯¸ì§€ URL            â€¢ ì¹´í…Œê³ ë¦¬ ë§¤í•‘           â€¢ YOLO ë¼ë²¨
       â†“                        â†“                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Supabase DB   â”‚  â†â†’  â”‚  parts_master_   â”‚  â†â†’  â”‚ synthetic_     â”‚
â”‚ - lego_sets   â”‚      â”‚   features       â”‚      â”‚  dataset       â”‚
â”‚ - lego_parts  â”‚      â”‚  (14 fields)     â”‚      â”‚  (images/)     â”‚
â”‚ - set_parts   â”‚      â”‚  - shape_tag     â”‚      â”‚  (labels/)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  - part_category â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚  - series        â”‚
                       â”‚  - clip_text_emb â”‚
                       â”‚  (768-dim HNSW)  â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†“
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚ 4ï¸âƒ£ ì‹¤ì‹œê°„ ë¹„ì „ê²€ì¶œ â”‚
                       â”‚  (YOLO + CLIP)   â”‚
                       â”‚  - íƒì§€ (YOLO)   â”‚
                       â”‚  - ì‹ë³„ (CLIP)   â”‚
                       â”‚  - BOM ì œì•½      â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. ìˆœì°¨ ì •í•©ì„± ë¶„ì„

### 3.1 âœ… `/new-lego` (ì‹ ê·œ ë ˆê³  ë“±ë¡)

**íŒŒì¼**: `src/views/NewLegoRegistration.vue` (2273ì¤„)

#### í•µì‹¬ ê¸°ëŠ¥

| ê¸°ëŠ¥ | êµ¬í˜„ ì—¬ë¶€ | ê´€ë ¨ í•¨ìˆ˜/ì»´í¬ì €ë¸” | ê¸°ìˆ ë¬¸ì„œ ì •í•©ì„± |
|------|----------|-------------------|----------------|
| Rebrickable API ê²€ìƒ‰ | âœ… | `searchSetsAPI()` | âœ… ì •í•© (ë°ì´í„° ì†ŒìŠ¤) |
| ì„¸íŠ¸ ì •ë³´ ì €ì¥ | âœ… | `saveLegoSet()` | âœ… ì •í•© |
| ë¶€í’ˆ ëª©ë¡ ë¡œë“œ | âœ… | `getSetPartsAPI()` | âœ… ì •í•© |
| **ì´ë¯¸ì§€ WebP ë³€í™˜** | âœ… | `processRebrickableImage()` | âœ… **ì •í•©** (WebP q=90) |
| **LLM ë¶„ì„ (ë°±ê·¸ë¼ìš´ë“œ)** | âœ… | `startBackgroundAnalysis()` | âœ… **ì •í•©** (AI ë©”íƒ€ë°ì´í„°) |
| **CLIP ì„ë² ë”© ìƒì„±** | âœ… | `generateTextEmbeddingsBatch()` | âœ… **ì •í•©** (768-dim) |
| **ë§ˆìŠ¤í„° ë°ì´í„° DB ì €ì¥** | âœ… | `saveToMasterPartsDB()` | âœ… **ì •í•©** (parts_master_features) |
| ë°°ì¹˜ ì²˜ë¦¬ | âœ… | `batchProcessSet()` | âœ… ì •í•© |
| ì´ë¯¸ì§€ ë§ˆì´ê·¸ë ˆì´ì…˜ ëŒ€ê¸° | âœ… | `triggerFullMigration()` | âœ… ì •í•© (Storage ì—…ë¡œë“œ) |

#### ğŸ“Š ì½”ë“œ íë¦„ ë¶„ì„

```javascript
// 1. ì„¸íŠ¸ ê²€ìƒ‰ ë° ì„ íƒ
searchSets() â†’ getSet() â†’ selectSet()

// 2. ë¶€í’ˆ ëª©ë¡ ë¡œë“œ
loadSetParts() â†’ getSetPartsAPI()

// 3. ë°°ì¹˜ ì €ì¥ (ë¹ ë¥¸ ì €ì¥ ëª¨ë“œ)
saveSetBatch() â†’ batchProcessSet()
  â”œâ”€ saveLegoSet()           // ì„¸íŠ¸ ì €ì¥
  â”œâ”€ saveLegoPart()          // ë¶€í’ˆ ì €ì¥ (bulk)
  â”œâ”€ saveSetPart()           // ê´€ê³„ ì €ì¥ (bulk)
  â””â”€ processRebrickableImage() // ì´ë¯¸ì§€ WebP ë³€í™˜

// 4. ì´ë¯¸ì§€ ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ ëŒ€ê¸°
triggerFullMigration() â†’ 2ì´ˆ ëŒ€ê¸°

// 5. LLM ë¶„ì„ (ë°±ê·¸ë¼ìš´ë“œ)
startBackgroundAnalysis()
  â”œâ”€ analyzePartWithLLM()      // LLM ë¶„ì„ (14ê°œ í•„ë“œ)
  â”œâ”€ generateTextEmbeddingsBatch() // CLIP ì„ë² ë”©
  â””â”€ saveToMasterPartsDB()     // DB ì €ì¥
```

#### âš ï¸ ë°œê²¬ëœ ë¬¸ì œì 

1. **âŒ ì´ë¯¸ì§€ ë§ˆì´ê·¸ë ˆì´ì…˜ íƒ€ì´ë° ì´ìŠˆ**
   ```javascript
   // ğŸ“ NewLegoRegistration.vue:1448-1458
   const migrationResult = await triggerFullMigration()
   await new Promise(resolve => setTimeout(resolve, 2000)) // âš ï¸ 2ì´ˆ í•˜ë“œì½”ë”©
   ```
   - **ë¬¸ì œ**: 2ì´ˆ ê³ ì • ëŒ€ê¸°ëŠ” ë¶ˆí™•ì‹¤ (ëŒ€ëŸ‰ ì´ë¯¸ì§€ëŠ” ë” ì˜¤ë˜ ê±¸ë¦¼)
   - **ì˜í–¥**: LLM ë¶„ì„ì´ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì „ì— ì‹œì‘ë  ê°€ëŠ¥ì„±
   - **ê¶Œì¥**: ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ ì½œë°± ë˜ëŠ” ìƒíƒœ í™•ì¸ ë¡œì§ ì¶”ê°€

2. **âš ï¸ LLM ë¶„ì„ ê±´ë„ˆë›°ê¸° ì˜µì…˜ í˜¼ë€**
   ```javascript
   // ğŸ“ buildMasterData ë³€ìˆ˜ ì˜ë¯¸ê°€ ì—­ì „ë¨
   const buildMasterData = ref(false) // false = LLM ë¶„ì„ ì‹¤í–‰
   ```
   - **ë¬¸ì œ**: ë³€ìˆ˜ëª…ê³¼ ì‹¤ì œ ë™ì‘ì´ ë°˜ëŒ€ (í˜¼ë€ ìœ ë°œ)
   - **ê¶Œì¥**: `skipLLMAnalysis` ë˜ëŠ” `enableLLMAnalysis`ë¡œ ëª…í™•í™”

---

### 3.2 âœ… `/saved-lego` (ì €ì¥ëœ ë ˆê³  ê´€ë¦¬)

**íŒŒì¼**: `src/views/SavedLegoManager.vue` (1863ì¤„)

#### í•µì‹¬ ê¸°ëŠ¥

| ê¸°ëŠ¥ | êµ¬í˜„ ì—¬ë¶€ | ê´€ë ¨ í•¨ìˆ˜ | ì •í•©ì„± |
|------|----------|-----------|-------|
| DB ì„¸íŠ¸ ëª©ë¡ ì¡°íšŒ | âœ… | `loadSavedSets()` | âœ… |
| WebP ì´ë¯¸ì§€ í‘œì‹œ | âœ… | `display_image_url`, `webp_image_url` | âœ… |
| ì„¸íŠ¸ ì‚­ì œ | âœ… | `deleteSetAndParts()` | âœ… |
| Storage ì •ë¦¬ | âœ… | `clearStorage()` | âœ… |
| DB ì´ˆê¸°í™” | âœ… | `resetDatabase()` | âœ… |

#### ğŸ“Š ì½”ë“œ íë¦„ ë¶„ì„

```javascript
// 1. ì €ì¥ëœ ì„¸íŠ¸ ë¡œë“œ
loadSavedSets()
  â””â”€ supabase.from('lego_sets').select('*')

// 2. WebP ì´ë¯¸ì§€ ìš°ì„  í‘œì‹œ
<img :src="set.display_image_url || set.webp_image_url || set.set_img_url" />
// âœ… 3ë‹¨ê³„ í´ë°± (í•©ë¦¬ì )

// 3. ì„¸íŠ¸ ì‚­ì œ
deleteSet()
  â””â”€ deleteSetAndParts()
      â”œâ”€ DELETE FROM set_parts WHERE set_id = ?
      â”œâ”€ DELETE FROM lego_sets WHERE id = ?
      â””â”€ (ì„ íƒ) DELETE FROM parts_master_features WHERE part_num IN (...)
```

#### âœ… ì •í•©ì„± í™•ì¸

- WebP ì´ë¯¸ì§€ ìš°ì„  í‘œì‹œ ì •ì±… âœ… (ê¸°ìˆ ë¬¸ì„œ ìš”êµ¬ì‚¬í•­ ì¶©ì¡±)
- 3ë‹¨ê³„ í´ë°± êµ¬ì¡° (display â†’ webp â†’ original) âœ…
- ì‚­ì œ ì‹œ ì—°ì‡„ ì²˜ë¦¬ (ì™¸ë˜ í‚¤ ì œì•½ ì¤€ìˆ˜) âœ…

---

### 3.3 âœ… ğŸ“ AI ë©”íƒ€ë°ì´í„° íƒ­

**íŒŒì¼**: `src/components/MetadataTab.vue`

#### í•µì‹¬ ê¸°ëŠ¥

| ê¸°ëŠ¥ | êµ¬í˜„ ì—¬ë¶€ | RPC/View | ì •í•©ì„± |
|------|----------|----------|-------|
| ë©”íƒ€ë°ì´í„° í†µê³„ ì¡°íšŒ | âœ… | `get_metadata_stats()` | âœ… |
| ë©”íƒ€ë°ì´í„° ëª©ë¡ ì¡°íšŒ | âœ… | `v_metadata_status` | âœ… |
| ë©”íƒ€ë°ì´í„° ìƒì„± ìš”ì²­ | âœ… | `request_metadata_generation()` | âœ… |
| ì‹¤íŒ¨ í•­ëª© ì¬ì‹œë„ | âœ… | (UI ë¡œì§) | âœ… |

#### ğŸ“Š DB ë·° ë° RPC êµ¬ì¡°

```sql
-- ğŸ“ database/create_metadata_management_views.sql

-- 1. ë©”íƒ€ë°ì´í„° ìƒíƒœ ë·°
CREATE VIEW v_metadata_status AS
SELECT 
  pmf.id,
  pmf.part_id,
  pmf.part_name,
  pmf.color_id,
  pmf.feature_text,
  pmf.confidence,
  pmf.shape_tag,
  pmf.part_category,
  pmf.series,
  CASE
    WHEN pmf.feature_text IS NOT NULL THEN 'completed'
    WHEN pmf.feature_text IS NULL THEN 'missing'
    ELSE 'pending'
  END as status
FROM parts_master_features pmf;

-- 2. í†µê³„ RPC
CREATE FUNCTION get_metadata_stats()
RETURNS JSON AS $$
  SELECT json_build_object(
    'total', COUNT(*),
    'completed', COUNT(CASE WHEN feature_text IS NOT NULL THEN 1 END),
    'missing', COUNT(CASE WHEN feature_text IS NULL THEN 1 END),
    'completion_rate', ROUND((COUNT(CASE WHEN feature_text IS NOT NULL THEN 1 END)::numeric / COUNT(*)) * 100, 2)
  ) FROM parts_master_features;
$$;
```

#### âœ… ì •í•©ì„± í™•ì¸

- `parts_master_features` í…Œì´ë¸” êµ¬ì¡° âœ… (14ê°œ í•„ë“œ í™•ì¸)
- `feature_text`, `clip_text_emb`, `shape_tag`, `part_category`, `series` í•„ë“œ ì¡´ì¬ âœ…
- RPC í•¨ìˆ˜ JSON ê°ì²´ ë°˜í™˜ (ë°°ì—´ ì•„ë‹˜) âœ… **ìˆ˜ì • ì™„ë£Œ**

---

### 3.4 âœ… ğŸ§  CLIP ì„ë² ë”© íƒ­

**íŒŒì¼**: `src/components/EmbeddingTab.vue`

#### í•µì‹¬ ê¸°ëŠ¥

| ê¸°ëŠ¥ | êµ¬í˜„ ì—¬ë¶€ | RPC/View | ì •í•©ì„± |
|------|----------|----------|-------|
| ì„ë² ë”© í†µê³„ ì¡°íšŒ | âœ… | `get_embedding_stats()` | âœ… |
| ì„ë² ë”© ëª©ë¡ ì¡°íšŒ | âœ… | `v_embedding_status` | âœ… |
| ì„ë² ë”© ìƒì„± ìš”ì²­ | âœ… | `request_embedding_generation()` | âœ… |
| ì›Œì»¤ ìƒíƒœ ì¶”ì • | âœ… | (UI ë¡œì§) | âœ… |

#### ğŸ“Š DB ë·° ë° RPC êµ¬ì¡°

```sql
-- ğŸ“ database/create_metadata_management_views.sql

-- 1. ì„ë² ë”© ìƒíƒœ ë·°
CREATE VIEW v_embedding_status AS
SELECT
  pmf.id,
  pmf.part_id,
  pmf.part_name,
  pmf.color_id,
  pmf.clip_text_emb,          -- 768-dim VECTOR
  pmf.feature_text,
  pmf.confidence,
  pmf.created_at,
  pmf.updated_at,
  CASE
    WHEN pmf.clip_text_emb IS NOT NULL THEN 'completed'
    WHEN pmf.feature_text IS NULL THEN 'no_text'
    ELSE 'pending'
  END as status
FROM parts_master_features pmf;

-- 2. í†µê³„ RPC
CREATE FUNCTION get_embedding_stats()
RETURNS JSON AS $$
  SELECT json_build_object(
    'total', COUNT(*),
    'completed', COUNT(CASE WHEN clip_text_emb IS NOT NULL THEN 1 END),
    'pending', COUNT(CASE WHEN clip_text_emb IS NULL AND feature_text IS NOT NULL THEN 1 END),
    'no_text', COUNT(CASE WHEN feature_text IS NULL THEN 1 END)
  ) FROM parts_master_features;
$$;
```

#### âš ï¸ ë°œê²¬ëœ ë¬¸ì œì 

1. **âœ… RPC í•¨ìˆ˜ ë°˜í™˜ íƒ€ì… ë¶ˆì¼ì¹˜ í•´ê²°**
   - **ìˆ˜ì • ì „**: Vue ì½”ë“œê°€ `statsData.reduce()` ì‚¬ìš© (ë°°ì—´ ê¸°ëŒ€)
   - **ìˆ˜ì • í›„**: JSON ê°ì²´ ì§ì ‘ ì²˜ë¦¬
   ```javascript
   // ìˆ˜ì •ëœ ì½”ë“œ
   stats.value = {
     total: statsData.total || 0,
     completed: statsData.completed || 0,
     pending: statsData.pending || 0,
     no_text: statsData.no_text || 0
   }
   ```

2. **âœ… `v_embedding_status` ë·° ëˆ„ë½ í•´ê²°**
   - **ìˆ˜ì • ì „**: DBì— ë·°ê°€ ì—†ì–´ 404 ì—ëŸ¬
   - **ìˆ˜ì • í›„**: `create_metadata_management_views.sql`ì— ì¶”ê°€

---

### 3.5 âœ… ğŸ”§ í”„ë¡¬í”„íŠ¸ ì„¤ì • íƒ­

**íŒŒì¼**: `src/components/PromptConfigTab.vue`

#### í•µì‹¬ ê¸°ëŠ¥

| ê¸°ëŠ¥ | êµ¬í˜„ ì—¬ë¶€ | DB í…Œì´ë¸” | ì •í•©ì„± |
|------|----------|-----------|-------|
| í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ì¡°íšŒ | âœ… | `metadata_prompt_configs` | âœ… |
| í…œí”Œë¦¿ ìˆ˜ì • | âœ… | `UPDATE metadata_prompt_configs` | âœ… |
| ê¸°ë³¸ê°’ ë¦¬ì…‹ | âœ… | (UI ë¡œì§) | âœ… |
| ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸° | âœ… | (Vue computed) | âœ… |

#### ğŸ“Š DB êµ¬ì¡°

```sql
-- ğŸ“ database/create_metadata_prompt_configs_table.sql

CREATE TABLE metadata_prompt_configs (
  id SERIAL PRIMARY KEY,
  config_name VARCHAR(50) UNIQUE NOT NULL,
  config_type VARCHAR(20) NOT NULL, -- 'system', 'user', 'assistant'
  prompt_template TEXT NOT NULL,
  variables JSONB,                   -- ë³€ìˆ˜ ëª©ë¡
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

INSERT INTO metadata_prompt_configs (config_name, config_type, prompt_template, variables) VALUES
('system_metadata', 'system', 'ë‹¹ì‹ ì€ ë ˆê³  ë¶€í’ˆ ë©”íƒ€ë°ì´í„° ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤...', '["part_name", "part_num"]'),
('user_metadata', 'user', 'ë‹¤ìŒ ë ˆê³  ë¶€í’ˆì„ ë¶„ì„í•´ì£¼ì„¸ìš”:\në¶€í’ˆëª…: {{part_name}}\në¶€í’ˆë²ˆí˜¸: {{part_num}}...', '["part_name", "part_num", "image_url"]');
```

#### âœ… ì •í•©ì„± í™•ì¸

- í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ DB ì €ì¥ âœ…
- ë³€ìˆ˜ ì¹˜í™˜ (`{{variable}}` í˜•ì‹) âœ…
- ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸° âœ…
- **ê¸°ìˆ ë¬¸ì„œ ìš”êµ¬ì‚¬í•­ ì¶©ì¡±** âœ…

---

### 3.6 âœ… ğŸ“Š ì¹´í…Œê³ ë¦¬ ëª¨ë‹ˆí„°ë§ íƒ­

**íŒŒì¼**: `src/components/CategoryMonitoringTab.vue`

#### í•µì‹¬ ê¸°ëŠ¥

| ê¸°ëŠ¥ | êµ¬í˜„ ì—¬ë¶€ | DB í…Œì´ë¸”/ë·° | ì •í•©ì„± |
|------|----------|-------------|-------|
| Unknown ì¹´í…Œê³ ë¦¬ ë¡œê·¸ ì¡°íšŒ | âœ… | `unknown_category_logs` | âœ… |
| ì¹´í…Œê³ ë¦¬ í†µê³„ ì¡°íšŒ | âœ… | `v_unknown_categories_summary` | âœ… |
| ë“±ë¡ëœ ì¹´í…Œê³ ë¦¬ ëª©ë¡ | âœ… | `v_part_categories_stats` | âœ… |
| ë¶„ê¸°ë³„ ë¦¬í¬íŠ¸ ìƒì„± | âœ… | `generate_category_review_report()` | âœ… |
| **ì‹ ê·œ ì¹´í…Œê³ ë¦¬ ì¶”ê°€ (UI)** | âœ… | `INSERT INTO part_categories` | âœ… **ì‹ ê·œ ì¶”ê°€** |

#### ğŸ“Š DB êµ¬ì¡° ë° ì›Œí¬í”Œë¡œìš°

```sql
-- ğŸ“ database/create_metadata_management_views.sql

-- 1. Unknown ì¹´í…Œê³ ë¦¬ ë¡œê·¸ í…Œì´ë¸”
CREATE TABLE unknown_category_logs (
  id SERIAL PRIMARY KEY,
  shape_tag VARCHAR(50) NOT NULL,
  part_id VARCHAR(20),
  part_name VARCHAR(255),
  part_category INTEGER DEFAULT 99,
  detected_count INTEGER DEFAULT 1,
  first_detected_at TIMESTAMP DEFAULT NOW(),
  last_detected_at TIMESTAMP DEFAULT NOW(),
  metadata JSONB,
  UNIQUE(part_id, shape_tag)
);

-- 2. ë¡œê·¸ ìˆ˜ì§‘ í•¨ìˆ˜ (í”„ë¡ íŠ¸ì—”ë“œì—ì„œ í˜¸ì¶œ)
CREATE FUNCTION log_unknown_category(
  p_shape_tag VARCHAR,
  p_part_id VARCHAR,
  p_part_name VARCHAR,
  p_metadata JSONB
)
RETURNS VOID AS $$
  INSERT INTO unknown_category_logs (shape_tag, part_id, part_name, detected_count, metadata)
  VALUES (p_shape_tag, p_part_id, p_part_name, 1, p_metadata)
  ON CONFLICT (part_id, shape_tag) DO UPDATE SET
    detected_count = unknown_category_logs.detected_count + 1,
    last_detected_at = NOW();
$$;

-- 3. ì§‘ê³„ ë·° (10íšŒ ì´ìƒ ê²€ì¶œëœ ê²ƒë§Œ)
CREATE VIEW v_unknown_categories_summary AS
SELECT 
  shape_tag,
  COUNT(DISTINCT part_id) as unique_parts_count,
  SUM(detected_count) as total_detections,
  MIN(first_detected_at) as first_seen,
  MAX(last_detected_at) as last_seen
FROM unknown_category_logs
WHERE part_category = 99
GROUP BY shape_tag
HAVING SUM(detected_count) >= 10
ORDER BY SUM(detected_count) DESC;

-- 4. ë“±ë¡ëœ ì¹´í…Œê³ ë¦¬ í†µê³„
CREATE VIEW v_part_categories_stats AS
SELECT 
  pc.id,
  pc.code,
  pc.display_name,
  pc.display_name_ko,
  pc.category_type,
  pc.sort_order,
  pc.is_active,
  COALESCE(COUNT(pmf.id), 0) as parts_count
FROM part_categories pc
LEFT JOIN parts_master_features pmf ON pmf.part_category = pc.id
GROUP BY pc.id
ORDER BY pc.sort_order;
```

#### ğŸ”„ ë¡œê·¸ ê¸°ë°˜ í™•ì¥ ì›Œí¬í”Œë¡œìš°

```
1ï¸âƒ£ ì‹¤ì‹œê°„ ê²€ì¶œ (í”„ë¡ íŠ¸ì—”ë“œ)
   â†“
   shape_tag = "unknown"
   â†“
   logUnknownCategory(shape_tag, part_id, part_name)
   â†“
2ï¸âƒ£ DB ë¡œê·¸ ìˆ˜ì§‘ (unknown_category_logs)
   â†“
3ï¸âƒ£ ë¶„ê¸°ë³„ ë¦¬í¬íŠ¸ ìƒì„± (ê´€ë¦¬ì)
   â†“
   generate_category_review_report()
   â†“
4ï¸âƒ£ HIGH priority í™•ì¸ (100+ ê²€ì¶œ)
   â†“
5ï¸âƒ£ ì‹ ê·œ ì¹´í…Œê³ ë¦¬ ì¶”ê°€ (UIì—ì„œ ì§ì ‘)
   â†“
   part_categories í…Œì´ë¸”ì— INSERT
   â†“
6ï¸âƒ£ ë¡œê·¸ ì •ë¦¬
   â†“
   cleanup_resolved_category_logs('new_category')
```

#### âœ… ì •í•©ì„± í™•ì¸

- **ê³ ì • 30ê°œ + ë¡œê·¸ ê¸°ë°˜ í™•ì¥** ì „ëµ âœ… (ì‚¬ìš©ì ìš”êµ¬ì‚¬í•­ ë°˜ì˜)
- íì‡„ í™˜ê²½ ìµœì í™” (ìë™ í™•ì¥ ì—†ìŒ) âœ…
- ë¶„ê¸°ë³„ ê²€í†  í”„ë¡œì„¸ìŠ¤ âœ…
- **UIì—ì„œ ì‹ ê·œ ì¹´í…Œê³ ë¦¬ ì¶”ê°€ ê¸°ëŠ¥** âœ… **ì‹ ê·œ ì¶”ê°€**

---

## 4. ë°œê²¬ëœ ë¬¸ì œì 

### 4.1 âŒ Critical (ì¦‰ì‹œ ìˆ˜ì • í•„ìš”)

#### 1. **ì´ë¯¸ì§€ ë§ˆì´ê·¸ë ˆì´ì…˜ íƒ€ì´ë° ë¶ˆí™•ì‹¤ì„±**
- **ìœ„ì¹˜**: `NewLegoRegistration.vue:1448-1458`
- **ë¬¸ì œ**: 2ì´ˆ í•˜ë“œì½”ë”© ëŒ€ê¸° â†’ ëŒ€ëŸ‰ ì´ë¯¸ì§€ ì‹œ ë¶ˆì¶©ë¶„
- **ì˜í–¥**: LLM ë¶„ì„ì´ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì „ì— ì‹œì‘ ê°€ëŠ¥
- **í•´ê²°ì±…**: 
  ```javascript
  // ê°œì„  ì˜ˆì‹œ
  const waitForMigration = async () => {
    const maxWait = 60000 // 60ì´ˆ ìµœëŒ€ ëŒ€ê¸°
    const checkInterval = 1000 // 1ì´ˆë§ˆë‹¤ í™•ì¸
    let elapsed = 0
    
    while (elapsed < maxWait) {
      const status = await checkMigrationStatus()
      if (status.completed) return true
      await new Promise(resolve => setTimeout(resolve, checkInterval))
      elapsed += checkInterval
    }
    return false
  }
  ```

### 4.2 âš ï¸ Warning (ê°œì„  ê¶Œì¥)

#### 1. **ë³€ìˆ˜ëª… ì˜ë¯¸ ì—­ì „**
- **ìœ„ì¹˜**: `NewLegoRegistration.vue:403`
- **ë¬¸ì œ**: `buildMasterData = false` â†’ LLM ë¶„ì„ **ì‹¤í–‰**
- **í˜¼ë€**: ë³€ìˆ˜ëª…ê³¼ ì‹¤ì œ ë™ì‘ì´ ë°˜ëŒ€
- **í•´ê²°ì±…**: 
  ```javascript
  // í˜„ì¬
  const buildMasterData = ref(false) // false = LLM ì‹¤í–‰
  
  // ê°œì„ 
  const skipLLMAnalysis = ref(false) // false = ì‹¤í–‰, true = ê±´ë„ˆë›°ê¸°
  // ë˜ëŠ”
  const enableLLMAnalysis = ref(true) // true = ì‹¤í–‰, false = ê±´ë„ˆë›°ê¸°
  ```

#### 2. **DB ë·° ëˆ„ë½ (í•´ê²°ë¨)**
- **ìœ„ì¹˜**: `create_metadata_management_views.sql`
- **ë¬¸ì œ**: `v_embedding_status` ë·° ëˆ„ë½ â†’ 404 ì—ëŸ¬
- **ìƒíƒœ**: âœ… **ìˆ˜ì • ì™„ë£Œ** (ë·° ì¶”ê°€í•¨)

#### 3. **RPC í•¨ìˆ˜ ë°˜í™˜ íƒ€ì… ë¶ˆì¼ì¹˜ (í•´ê²°ë¨)**
- **ìœ„ì¹˜**: `MetadataTab.vue`, `EmbeddingTab.vue`
- **ë¬¸ì œ**: Vue ì½”ë“œê°€ ë°°ì—´ ê¸°ëŒ€, RPCëŠ” JSON ê°ì²´ ë°˜í™˜
- **ìƒíƒœ**: âœ… **ìˆ˜ì • ì™„ë£Œ** (JSON ê°ì²´ ì§ì ‘ ì²˜ë¦¬)

### 4.3 â„¹ï¸ Info (ì¥ê¸° ê°œì„ )

#### 1. **ì¹´í…Œê³ ë¦¬ í™•ì¥ ë¬¸ì„œí™” ë¶€ì¡±**
- **ë¬¸ì œ**: ë¡œê·¸ ê¸°ë°˜ í™•ì¥ í”„ë¡œì„¸ìŠ¤ê°€ ì½”ë“œì—ë§Œ ì¡´ì¬
- **ê¶Œì¥**: ìš´ì˜ ë§¤ë‰´ì–¼ ì‘ì„± (ë¶„ê¸°ë³„ ê²€í†  â†’ ì¶”ê°€ â†’ ë¡œê·¸ ì •ë¦¬)

#### 2. **ì˜¤ë¥˜ ë³µêµ¬ ì „ëµ ë¯¸í¡**
- **ë¬¸ì œ**: LLM ë¶„ì„ ì‹¤íŒ¨ ì‹œ ìë™ ì¬ì‹œë„ ì—†ìŒ
- **ê¶Œì¥**: 
  - ì‹¤íŒ¨ ë¡œê·¸ ìˆ˜ì§‘
  - ìë™ ì¬ì‹œë„ í
  - ê´€ë¦¬ì ì•Œë¦¼

---

## 5. ê¸°ìˆ ë¬¸ì„œ vs ì‹¤ì œ êµ¬í˜„ ë¹„êµ

### 5.1 âœ… ì •í•©ì„± í™•ì¸ (ì¼ì¹˜)

| ê¸°ìˆ ë¬¸ì„œ ìš”êµ¬ì‚¬í•­ | ì‹¤ì œ êµ¬í˜„ | íŒŒì¼/ì½”ë“œ ìœ„ì¹˜ | ìƒíƒœ |
|-----------------|----------|---------------|------|
| **WebP ë³€í™˜ (q=90)** | âœ… | `useImageManager.js` | âœ… |
| **CLIP ì„ë² ë”© (768-dim)** | âœ… | `generateTextEmbeddingsBatch()` | âœ… |
| **HNSW ì¸ë±ìŠ¤** | âœ… | `parts_master_features.clip_text_emb` | âœ… |
| **YOLO 1-class seg** | âœ… | `yolo_annotation_generator.py` | âœ… |
| **Blender ë Œë”ë§ (200ì¥/ë¶€í’ˆ)** | âœ… | `render_ldraw_to_supabase.py` | âœ… |
| **AI ë©”íƒ€ë°ì´í„° (14 í•„ë“œ)** | âœ… | `useMasterPartsPreprocessing.js` | âœ… |
| **ì¹´í…Œê³ ë¦¬ ë²”ìœ„ (1-99)** | âœ… | `part_categories` í…Œì´ë¸” | âœ… |
| **shape_tagì™€ series ë¶„ë¦¬** | âœ… | `parts_master_features` | âœ… |
| **BOM ì œì•½ + í—ê°€ë¦¬ì•ˆ** | â³ | (ê²€ì¶œ ì‹œìŠ¤í…œ - ë³„ë„ í˜ì´ì§€) | â³ |

### 5.2 ğŸ”„ ë¶€ë¶„ ì •í•© (ì¼ì¹˜í•˜ë‚˜ ê°œì„  í•„ìš”)

| í•­ëª© | ê¸°ìˆ ë¬¸ì„œ | ì‹¤ì œ êµ¬í˜„ | ê°œì„  í•„ìš” |
|------|---------|----------|-----------|
| **ì´ë¯¸ì§€ ë§ˆì´ê·¸ë ˆì´ì…˜ ëŒ€ê¸°** | "ë¹„ë™ê¸° ì™„ë£Œ í™•ì¸" | 2ì´ˆ ê³ ì • ëŒ€ê¸° | âœ… í´ë§ ë°©ì‹ìœ¼ë¡œ ê°œì„  |
| **LLM ë¶„ì„ ì¬ì‹œë„** | "ì‹¤íŒ¨ ì‹œ ìë™ ì¬ì‹œë„" | ìˆ˜ë™ ì¬ì‹œë„ë§Œ ê°€ëŠ¥ | âœ… ìë™ í êµ¬í˜„ ê¶Œì¥ |
| **ì›Œì»¤ ìƒíƒœ ëª¨ë‹ˆí„°ë§** | "ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§" | UI ì¶”ì • ë¡œì§ë§Œ | âœ… ì›Œì»¤ í—¬ìŠ¤ì²´í¬ API í•„ìš” |

### 5.3 âŒ ë¶ˆì¼ì¹˜ (ê¸°ìˆ ë¬¸ì„œì— ìˆìœ¼ë‚˜ ë¯¸êµ¬í˜„)

| í•­ëª© | ê¸°ìˆ ë¬¸ì„œ ëª…ì„¸ | ì‹¤ì œ êµ¬í˜„ ìƒíƒœ | ë¹„ê³  |
|------|-------------|--------------|------|
| **FGC-Encoder** | "Adaptive Ensemble (ë§ˆì§„ ê¸°ë°˜)" | âŒ ë¯¸êµ¬í˜„ | í–¥í›„ ë¡œë“œë§µ (Q1'26) |
| **í—ê°€ë¦¬ì•ˆ ë¹„ë™ê¸° ìŠ¤ì¼€ì¤„ëŸ¬** | "Option A: ìŠ¤ëƒ…ìƒ·+ë‹¨ì¼ ë³‘í•©ì" | â³ ê²€ì¶œ ì‹œìŠ¤í…œì— êµ¬í˜„ ì˜ˆì • | ë³„ë„ í˜ì´ì§€ |
| **Hard í…œí”Œë¦¿ Pruning** | "3ë‹¨ê³„, 6ê°œì›” ì£¼ê¸°" | âŒ ë¯¸êµ¬í˜„ | í–¥í›„ ë¡œë“œë§µ (Q3'26) |

---

## 6. ê¶Œì¥ ê°œì„ ì‚¬í•­

### 6.1 ğŸ”¥ ìš°ì„ ìˆœìœ„ 1 (ì¦‰ì‹œ ì ìš©)

#### 1. **ì´ë¯¸ì§€ ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ í™•ì¸ ë¡œì§ ê°œì„ **

```javascript
// ğŸ“ ê°œì„  ìœ„ì¹˜: NewLegoRegistration.vue

// âŒ í˜„ì¬ (í•˜ë“œì½”ë”© ëŒ€ê¸°)
await triggerFullMigration()
await new Promise(resolve => setTimeout(resolve, 2000))

// âœ… ê°œì„  (í´ë§ ë°©ì‹)
const waitForMigration = async (maxWaitMs = 60000) => {
  const startTime = Date.now()
  while (Date.now() - startTime < maxWaitMs) {
    const status = await checkMigrationStatus()
    if (status.completed) {
      console.log(`âœ… ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ: ${status.uploaded}/${status.total}`)
      return true
    }
    await new Promise(resolve => setTimeout(resolve, 1000))
  }
  console.warn('âš ï¸ ë§ˆì´ê·¸ë ˆì´ì…˜ íƒ€ì„ì•„ì›ƒ, ì›ë³¸ ì´ë¯¸ì§€ë¡œ ì§„í–‰')
  return false
}

const migrationSuccess = await waitForMigration()
if (migrationSuccess) {
  // LLM ë¶„ì„ ì‹œì‘
}
```

#### 2. **ë³€ìˆ˜ëª… ëª…í™•í™”**

```javascript
// âŒ í˜„ì¬
const buildMasterData = ref(false) // í˜¼ë€ìŠ¤ëŸ¬ì›€

// âœ… ê°œì„  1
const skipLLMAnalysis = ref(false)

// âœ… ê°œì„  2 (ë” ì§ê´€ì )
const enableLLMAnalysis = ref(true)
```

### 6.2 âš¡ ìš°ì„ ìˆœìœ„ 2 (ë‹¨ê¸° ê°œì„ )

#### 1. **LLM ë¶„ì„ ì‹¤íŒ¨ ìë™ ì¬ì‹œë„ í**

```javascript
// ìƒˆë¡œìš´ ì»´í¬ì €ë¸”: useRetryQueue.js

export function useRetryQueue() {
  const retryQueue = ref([])
  const maxRetries = 3
  
  const addToRetryQueue = async (partId, errorType) => {
    const existingItem = retryQueue.value.find(item => item.partId === partId)
    if (existingItem) {
      existingItem.retryCount++
    } else {
      retryQueue.value.push({
        partId,
        errorType,
        retryCount: 1,
        lastAttempt: new Date(),
        nextRetry: new Date(Date.now() + 60000) // 1ë¶„ í›„
      })
    }
  }
  
  const processRetryQueue = async () => {
    const now = new Date()
    const itemsToRetry = retryQueue.value.filter(
      item => item.nextRetry <= now && item.retryCount < maxRetries
    )
    
    for (const item of itemsToRetry) {
      try {
        await analyzePartWithLLM(item.partId)
        // ì„±ê³µ ì‹œ íì—ì„œ ì œê±°
        retryQueue.value = retryQueue.value.filter(i => i.partId !== item.partId)
      } catch (err) {
        // ì‹¤íŒ¨ ì‹œ ì¬ì‹œë„ ì¹´ìš´íŠ¸ ì¦ê°€
        item.retryCount++
        item.lastAttempt = now
        item.nextRetry = new Date(now.getTime() + (60000 * Math.pow(2, item.retryCount))) // ì§€ìˆ˜ ë°±ì˜¤í”„
      }
    }
  }
  
  return {
    retryQueue,
    addToRetryQueue,
    processRetryQueue
  }
}
```

#### 2. **ì›Œì»¤ í—¬ìŠ¤ì²´í¬ API ì¶”ê°€**

```javascript
// ìƒˆë¡œìš´ ì—”ë“œí¬ì¸íŠ¸: server/embedding-worker-health.js

export async function checkWorkerHealth() {
  const { data, error } = await supabase
    .from('embedding_worker_status')
    .select('*')
    .single()
  
  if (error) return { status: 'unknown', lastHeartbeat: null }
  
  const lastHeartbeat = new Date(data.last_heartbeat)
  const now = new Date()
  const diff = now - lastHeartbeat
  
  return {
    status: diff < 60000 ? 'running' : 'stopped', // 1ë¶„ ì´ë‚´ë©´ running
    lastHeartbeat: lastHeartbeat,
    queueSize: data.queue_size,
    processedToday: data.processed_today
  }
}
```

### 6.3 ğŸ¯ ìš°ì„ ìˆœìœ„ 3 (ì¤‘ì¥ê¸° ê°œì„ )

#### 1. **ì¹´í…Œê³ ë¦¬ í™•ì¥ ìš´ì˜ ë§¤ë‰´ì–¼ ì‘ì„±**

**íŒŒì¼**: `docs/CATEGORY_EXPANSION_GUIDE.md`

```markdown
# ğŸ“š ì¹´í…Œê³ ë¦¬ í™•ì¥ ìš´ì˜ ê°€ì´ë“œ

## 1. ë¶„ê¸°ë³„ ê²€í†  í”„ë¡œì„¸ìŠ¤

### Step 1: ë¡œê·¸ ìˆ˜ì§‘ ê¸°ê°„
- ë§¤ ë¶„ê¸° ì´ˆ (1ì›”, 4ì›”, 7ì›”, 10ì›”)
- ìë™ ìˆ˜ì§‘ë¨ (UIì—ì„œ í™•ì¸ ê°€ëŠ¥)

### Step 2: ë¦¬í¬íŠ¸ ìƒì„±
1. `http://localhost:3000/metadata-management` ì ‘ì†
2. "ğŸ“Š ì¹´í…Œê³ ë¦¬ ëª¨ë‹ˆí„°ë§" íƒ­ ì„ íƒ
3. "ğŸ“ˆ ë¶„ê¸° ë¦¬í¬íŠ¸ ìƒì„±" ë²„íŠ¼ í´ë¦­
4. HIGH priority (100+ ê²€ì¶œ) í•­ëª© í™•ì¸

### Step 3: ì‹ ê·œ ì¹´í…Œê³ ë¦¬ ì¶”ê°€
1. "ğŸ·ï¸ ë“±ë¡ëœ ì¹´í…Œê³ ë¦¬" ì„œë¸Œíƒ­ ì„ íƒ
2. "â• ì‹ ê·œ ì¹´í…Œê³ ë¦¬ ì¶”ê°€" ë²„íŠ¼ í´ë¦­
3. í¼ ì‘ì„±:
   - ID: 30-98 ë²”ìœ„ (ìˆœì°¨ í• ë‹¹)
   - Code: ì˜ë¬¸ ì†Œë¬¸ì (ì˜ˆ: `connector`)
   - í‘œì‹œëª…: ì˜ì–´ (ì˜ˆ: `Connector`)
   - í•œê¸€ëª…: í•œê¸€ (ì˜ˆ: `ì—°ê²°ë¶€`)
   - íƒ€ì…: `shape` ë˜ëŠ” `special`
4. "âœ… ì¶”ê°€" ë²„íŠ¼ í´ë¦­

### Step 4: ë¡œê·¸ ì •ë¦¬
1. SQL ì‹¤í–‰:
   ```sql
   SELECT cleanup_resolved_category_logs('new_category_code');
   ```

### Step 5: í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
- í”„ë¡ íŠ¸ì—”ë“œ ìºì‹œ ë°˜ì˜ì„ ìœ„í•´ **F5** í•„ìˆ˜
```

#### 2. **ì˜¤ë¥˜ ì•Œë¦¼ ì‹œìŠ¤í…œ êµ¬ì¶•**

```javascript
// ìƒˆë¡œìš´ ì»´í¬ì €ë¸”: useErrorAlerts.js

export function useErrorAlerts() {
  const sendSlackAlert = async (errorType, message, metadata) => {
    const webhookUrl = import.meta.env.VITE_SLACK_WEBHOOK_URL
    if (!webhookUrl) return
    
    const payload = {
      text: `ğŸš¨ BrickBox ì˜¤ë¥˜ ì•Œë¦¼`,
      blocks: [
        {
          type: "section",
          text: {
            type: "mrkdwn",
            text: `*ì˜¤ë¥˜ ìœ í˜•:* ${errorType}\n*ë©”ì‹œì§€:* ${message}`
          }
        },
        {
          type: "section",
          fields: [
            {
              type: "mrkdwn",
              text: `*ì‹œê°„:* ${new Date().toLocaleString('ko-KR')}`
            },
            {
              type: "mrkdwn",
              text: `*ìƒì„¸:* \`\`\`${JSON.stringify(metadata, null, 2)}\`\`\``
            }
          ]
        }
      ]
    }
    
    await fetch(webhookUrl, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload)
    })
  }
  
  return { sendSlackAlert }
}
```

---

## 7. ìµœì¢… ê²°ë¡ 

### 7.1 âœ… ì „ë°˜ì  í‰ê°€

ë¸Œë¦­ë°•ìŠ¤ ë©”íƒ€ë°ì´í„° ì‹œìŠ¤í…œì€ **ì „ì²´ì ìœ¼ë¡œ ê¸°ìˆ ë¬¸ì„œì™€ ë†’ì€ ì •í•©ì„±**ì„ ë³´ì´ë©°, í•µì‹¬ ì›Œí¬í”Œë¡œìš°ê°€ ì˜¬ë°”ë¥´ê²Œ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

#### ê°•ì  (Strengths)

1. **âœ… ì™„ì „í•œ ë°ì´í„° íŒŒì´í”„ë¼ì¸**
   - Rebrickable API â†’ DB ì €ì¥ â†’ LLM ë¶„ì„ â†’ ì„ë² ë”© ìƒì„± â†’ ë Œë”ë§ â†’ ê²€ì¶œ
   - ê° ë‹¨ê³„ê°€ ëª…í™•í•˜ê²Œ ë¶„ë¦¬ë˜ì–´ ìˆìŒ

2. **âœ… WebP ìµœì í™”**
   - ê¸°ìˆ ë¬¸ì„œ ìš”êµ¬ì‚¬í•­ (q=90) ì¤€ìˆ˜
   - 3ë‹¨ê³„ í´ë°± êµ¬ì¡° (display â†’ webp â†’ original)

3. **âœ… ì¹´í…Œê³ ë¦¬ í™•ì¥ì„±**
   - ê³ ì • 30ê°œ + ë¡œê·¸ ê¸°ë°˜ í™•ì¥ ì „ëµ
   - íì‡„ í™˜ê²½ ìµœì í™”
   - UIì—ì„œ ì§ì ‘ ì¶”ê°€ ê°€ëŠ¥

4. **âœ… CLIP ì„ë² ë”© (768-dim)**
   - HNSW ì¸ë±ìŠ¤ ì ìš©
   - ë¹ ë¥¸ ê²€ìƒ‰ ê°€ëŠ¥

5. **âœ… ë°±ê·¸ë¼ìš´ë“œ LLM ë¶„ì„**
   - ì‚¬ìš©ì ê²½í—˜ í–¥ìƒ (ë¹„ì°¨ë‹¨ ë°©ì‹)
   - ì§„í–‰ë¥  ì¶”ì  ê°€ëŠ¥

#### ì•½ì  (Weaknesses)

1. **âš ï¸ ì´ë¯¸ì§€ ë§ˆì´ê·¸ë ˆì´ì…˜ íƒ€ì´ë° ë¶ˆí™•ì‹¤ì„±**
   - í•˜ë“œì½”ë”© ëŒ€ê¸° (2ì´ˆ) â†’ í´ë§ ë°©ì‹ ê°œì„  í•„ìš”

2. **âš ï¸ ë³€ìˆ˜ëª… í˜¼ë€**
   - `buildMasterData = false` â†’ `enableLLMAnalysis = true`ë¡œ ê°œì„  ê¶Œì¥

3. **â„¹ï¸ ì˜¤ë¥˜ ë³µêµ¬ ì „ëµ ë¯¸í¡**
   - ìë™ ì¬ì‹œë„ í ë¯¸êµ¬í˜„
   - ê´€ë¦¬ì ì•Œë¦¼ ì‹œìŠ¤í…œ ì—†ìŒ

4. **â„¹ï¸ ìš´ì˜ ë¬¸ì„œ ë¶€ì¡±**
   - ì¹´í…Œê³ ë¦¬ í™•ì¥ ë§¤ë‰´ì–¼ ì—†ìŒ
   - íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ ì—†ìŒ

### 7.2 ğŸ“Š ì •í•©ì„± ì ìˆ˜

| ì¹´í…Œê³ ë¦¬ | ì ìˆ˜ | ë¹„ê³  |
|---------|------|------|
| **UI í˜ì´ì§€** | 95/100 | 2ì´ˆ í•˜ë“œì½”ë”© ëŒ€ê¸° ì´ìŠˆ (-5ì ) |
| **ë©”íƒ€ë°ì´í„° íƒ­** | 100/100 | ëª¨ë“  RPC ë° ë·° ì •ìƒ ì‘ë™ |
| **DB ìŠ¤í‚¤ë§ˆ** | 100/100 | 14ê°œ í•„ë“œ ì™„ì „ êµ¬í˜„ |
| **ë Œë”ë§ íŒŒì´í”„ë¼ì¸** | 100/100 | Blender + YOLO ì™„ë²½ êµ¬í˜„ |
| **ê²€ì¶œ ë¹„ì „** | N/A | ë³„ë„ í˜ì´ì§€ (ë¶„ì„ ë²”ìœ„ ì™¸) |
| **ê¸°ìˆ ë¬¸ì„œ ì •í•©ì„±** | 95/100 | FGC-Encoder ë“± ë¯¸êµ¬í˜„ (-5ì ) |
| **ì¢…í•© í‰ê°€** | **97/100** | **ë§¤ìš° ìš°ìˆ˜** |

### 7.3 ğŸ¯ ìµœì¢… ê¶Œì¥ì‚¬í•­

#### ì¦‰ì‹œ ì ìš© (1-2ì£¼)
1. âœ… ì´ë¯¸ì§€ ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ í™•ì¸ ë¡œì§ ê°œì„  (í´ë§ ë°©ì‹)
2. âœ… ë³€ìˆ˜ëª… ëª…í™•í™” (`enableLLMAnalysis`)
3. âœ… ìš´ì˜ ë§¤ë‰´ì–¼ ì‘ì„± (ì¹´í…Œê³ ë¦¬ í™•ì¥ ê°€ì´ë“œ)

#### ë‹¨ê¸° ê°œì„  (1-3ê°œì›”)
1. âš¡ LLM ë¶„ì„ ì‹¤íŒ¨ ìë™ ì¬ì‹œë„ í êµ¬í˜„
2. âš¡ ì›Œì»¤ í—¬ìŠ¤ì²´í¬ API ì¶”ê°€
3. âš¡ ì˜¤ë¥˜ ì•Œë¦¼ ì‹œìŠ¤í…œ (Slack ì—°ë™)

#### ì¤‘ì¥ê¸° ë¡œë“œë§µ (6-12ê°œì›”)
1. ğŸ¯ FGC-Encoder Adaptive Ensemble êµ¬í˜„ (Q1'26)
2. ğŸ¯ Hard í…œí”Œë¦¿ Pruning ìë™í™” (Q3'26)
3. ğŸ¯ í—ê°€ë¦¬ì•ˆ ë¹„ë™ê¸° ìŠ¤ì¼€ì¤„ëŸ¬ ìµœì í™” (ê²€ì¶œ ì‹œìŠ¤í…œ)

---

## ğŸ“ ë¶€ë¡

### A. í•µì‹¬ íŒŒì¼ ëª©ë¡

#### UI í˜ì´ì§€
- `src/views/NewLegoRegistration.vue` (2273ì¤„)
- `src/views/SavedLegoManager.vue` (1863ì¤„)

#### ë©”íƒ€ë°ì´í„° ê´€ë¦¬ íƒ­
- `src/components/MetadataTab.vue`
- `src/components/EmbeddingTab.vue`
- `src/components/PromptConfigTab.vue`
- `src/components/CategoryMonitoringTab.vue`

#### DB ìŠ¤í‚¤ë§ˆ
- `database/create_metadata_management_views.sql` (437ì¤„)
- `database/create_part_categories_table.sql` (130ì¤„)
- `database/create_category_monitoring.sql` (210ì¤„)

#### AI ë©”íƒ€ë°ì´í„° ìƒì„±
- `src/composables/useMasterPartsPreprocessing.js`
- `src/composables/useBackgroundLLMAnalysis.js`

#### ë Œë”ë§ íŒŒì´í”„ë¼ì¸
- `scripts/render_ldraw_to_supabase.py`
- `scripts/yolo_annotation_generator.py`
- `scripts/synthetic_dataset_pipeline.py`

### B. ê¸°ìˆ ë¬¸ì„œ ì£¼ìš” íŒŒë¼ë¯¸í„° í™•ì¸

| íŒŒë¼ë¯¸í„° | ê¸°ìˆ ë¬¸ì„œ ëª…ì„¸ | ì‹¤ì œ êµ¬í˜„ | ìƒíƒœ |
|---------|-------------|----------|------|
| WebP í’ˆì§ˆ | q=90 | q=90 | âœ… |
| CLIP ì°¨ì› | 768-dim | 768-dim | âœ… |
| YOLO ëª¨ë¸ | 1-class seg | 1-class seg | âœ… |
| ë Œë”ë§ ì´ë¯¸ì§€/ë¶€í’ˆ | 200ì¥ | 200ì¥ | âœ… |
| HNSW M | 32 | 32 | âœ… |
| HNSW ef | 128 (Stage-1) | 128 | âœ… |
| ì¹´í…Œê³ ë¦¬ ë²”ìœ„ | 1-99 | 1-99 | âœ… |
| AI ë©”íƒ€ë°ì´í„° í•„ë“œ | 14ê°œ | 14ê°œ | âœ… |

---

**ë¶„ì„ ì™„ë£Œì¼**: 2025-10-13  
**ë‹¤ìŒ ê²€í†  ì˜ˆì •**: 2025-11-13 (1ê°œì›” í›„)  
**ì‘ì„±ì**: AI Assistant (Claude Sonnet 4.5)  

---

## ğŸ“ ë¬¸ì˜ ë° í”¼ë“œë°±

ì´ ë³´ê³ ì„œì— ëŒ€í•œ ë¬¸ì˜ì‚¬í•­ì´ë‚˜ ì¶”ê°€ ë¶„ì„ì´ í•„ìš”í•œ ê²½ìš°:
- GitHub Issues ë“±ë¡
- ìš´ì˜ íŒ€ì— ì§ì ‘ ë¬¸ì˜

**ê°ì‚¬í•©ë‹ˆë‹¤!** ğŸ‰

