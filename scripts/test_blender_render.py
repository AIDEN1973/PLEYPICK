#!/usr/bin/env python3 """ BrickBox Blender í…ŒìŠ¤íŠ¸ ë Œë”ë§ ìŠ¤í¬ë¦½íŠ¸ Blender ë‚´ë¶€ì—ì„œ ì‹¤í–‰ë˜ëŠ” ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ - LDraw íŒŒì¼ ë¡œë“œ í…ŒìŠ¤íŠ¸ - ê¸°ë³¸ ë Œë”ë§ í…ŒìŠ¤íŠ¸ - ë¡œì»¬ íŒŒì¼ ì €ì¥ """ import bpy import bmesh import os import sys import math import mathutils from mathutils import Vector, Euler import random def clear_scene(): """ì”¬ ì´ˆê¸°í™”""" bpy.ops.object.select_all(action='SELECT') bpy.ops.object.delete(use_global=False) def setup_camera(): """ì¹´ë©”ë¼ ì„¤ì •""" bpy.ops.object.camera_add(location=(0, -5, 2)) camera = bpy.context.object camera.name = "TestCamera" camera.rotation_euler = (math.radians(60), 0, 0) bpy.context.scene.camera = camera def setup_lighting(): """ì¡°ëª… ì„¤ì •""" # í‚¤ ë¼ì´íŠ¸ bpy.ops.object.light_add(type='SUN', location=(2, -2, 5)) key_light = bpy.context.object key_light.name = "KeyLight" key_light.data.energy = 3.0 # í•„ ë¼ì´íŠ¸ bpy.ops.object.light_add(type='AREA', location=(-2, -1, 3)) fill_light = bpy.context.object fill_light.name = "FillLight" fill_light.data.energy = 1.5 def setup_render_settings(): """ë Œë”ë§ ì„¤ì •""" bpy.context.scene.render.engine = 'CYCLES' bpy.context.scene.render.resolution_x = 640 bpy.context.scene.render.resolution_y = 640 bpy.context.scene.cycles.samples = 32 bpy.context.scene.render.image_settings.file_format = 'WEBP' bpy.context.scene.render.image_settings.quality = 80 # WebP Q80 í’ˆì§ˆ ì„¤ì • bpy.context.scene.render.image_settings.color_mode = 'RGB' def load_ldraw_part(part_path): """LDraw ë¶€í’ˆ ë¡œë“œ""" try: # LDraw Importer Add-on ìë™ í™œì„±í™” (Blender 4.5.3 LTS ìµœì í™”) import addon_utils # Add-on í™œì„±í™” (default_set=Trueë¡œ ì„¤ì • ì €ì¥) try: addon_utils.enable("ImportLDraw-master", default_set=True) print(" LDraw Importer Add-on í™œì„±í™” ì™„ë£Œ (ì„¤ì • ì €ì¥ë¨)") except Exception as e: print(f" Add-on í™œì„±í™” ì‹¤íŒ¨: {e}") return None # LDraw í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (ê²½ë¡œ ë¬¸ì œ í•´ê²°) import os os.environ['LDRAWDIR'] = 'C:/LDraw' print(" LDraw í™˜ê²½ ë³€ìˆ˜ ì„¤ì •: C:/LDraw") # LDraw íŒŒì¼ ì„í¬íŠ¸ (ì˜¬ë°”ë¥¸ operator ì‚¬ìš©) bpy.ops.import_scene.importldraw(filepath=part_path) # ì„í¬íŠ¸ëœ ê°ì²´ ì„ íƒ imported_objects = [obj for obj in bpy.context.scene.objects if obj.type == 'MESH'] if not imported_objects: print(" LDraw íŒŒì¼ì—ì„œ ë©”ì‹œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤") return None # ëª¨ë“  ë©”ì‹œë¥¼ í•˜ë‚˜ì˜ ê°ì²´ë¡œ ê²°í•© if len(imported_objects) > 1: bpy.context.view_layer.objects.active = imported_objects[0] bpy.ops.object.select_all(action='DESELECT') for obj in imported_objects: obj.select_set(True) bpy.ops.object.join() part_object = bpy.context.active_object part_object.name = "LEGOPart" print(f" LDraw ë¶€í’ˆ ë¡œë“œ ì„±ê³µ: {part_object.name}") return part_object except Exception as e: print(f" LDraw ë¡œë“œ ì‹¤íŒ¨: {e}") return None def apply_random_material(part_object): """ëœë¤ ì¬ì§ˆ ì ìš©""" material = bpy.data.materials.new(name="LEGOMaterial") material.use_nodes = True nodes = material.node_tree.nodes nodes.clear() bsdf = nodes.new(type='ShaderNodeBsdfPrincipled') output = nodes.new(type='ShaderNodeOutputMaterial') material.node_tree.links.new(bsdf.outputs['BSDF'], output.inputs['Surface']) # ëœë¤ ìƒ‰ìƒ colors = [ (0.8, 0.1, 0.1, 1.0), # ë¹¨ê°• (0.1, 0.3, 0.8, 1.0), # íŒŒë‘ (0.1, 0.7, 0.2, 1.0), # ì´ˆë¡ (0.9, 0.8, 0.1, 1.0), # ë…¸ë‘ (0.95, 0.95, 0.95, 1.0) # í°ìƒ‰ ] color = random.choice(colors) bsdf.inputs['Base Color'].default_value = color bsdf.inputs['Metallic'].default_value = 0.0 bsdf.inputs['Roughness'].default_value = 0.3 if part_object.data.materials: part_object.data.materials[0] = material else: part_object.data.materials.append(material) print(f" ì¬ì§ˆ ì ìš© ì™„ë£Œ: {color}") return color def render_image(output_path): """ì´ë¯¸ì§€ ë Œë”ë§""" bpy.context.scene.render.filepath = output_path bpy.ops.render.render(write_still=True) print(f" ë Œë”ë§ ì™„ë£Œ: {output_path}") def main(): """ë©”ì¸ ì‹¤í–‰ í•¨ìˆ˜""" print(" BrickBox Blender í…ŒìŠ¤íŠ¸ ë Œë”ë§ ì‹œì‘") # ì¶œë ¥ ë””ë ‰í† ë¦¬ ìƒì„± output_dir = "./output/test" os.makedirs(output_dir, exist_ok=True) # ì”¬ ì´ˆê¸°í™” clear_scene() # ë Œë”ë§ ì„¤ì • setup_render_settings() setup_camera() setup_lighting() # LDraw ë¶€í’ˆ ë¡œë“œ part_path = "C:/LDraw/parts/3001.dat" part_object = load_ldraw_part(part_path) if not part_object: print(" ë¶€í’ˆ ë¡œë“œ ì‹¤íŒ¨") return # ëœë¤ ì¬ì§ˆ ì ìš© color = apply_random_material(part_object) # ëœë¤ íšŒì „ ì ìš© rotation_x = random.uniform(0, 2 * math.pi) rotation_y = random.uniform(0, 2 * math.pi) rotation_z = random.uniform(0, 2 * math.pi) part_object.rotation_euler = (rotation_x, rotation_y, rotation_z) print(f" íšŒì „ ì ìš©: ({math.degrees(rotation_x):.1f}Â°, {math.degrees(rotation_y):.1f}Â°, {math.degrees(rotation_z):.1f}Â°)") # ë Œë”ë§ output_path = os.path.join(output_dir, "test_3001.png") render_image(output_path) print(" í…ŒìŠ¤íŠ¸ ë Œë”ë§ ì™„ë£Œ!") print(f"ğŸ“ ì¶œë ¥ íŒŒì¼: {output_path}") if __name__ == "__main__": main() 