# Element ID κ²€μƒ‰ κΈ°λ¥ κµ¬ν„ μ™„λ£ λ³΄κ³ μ„

## π“… μ‘μ—…μΌ: 2025-10-13

## π― κµ¬ν„ λ©ν‘
Element IDλ¥Ό κ²€μƒ‰ν•μ—¬ ν•΄λ‹Ή λ¶€ν’μ΄ ν¬ν•¨λ λ κ³  μ„ΈνΈλ¥Ό μ°Ύμ„ μ μλ” κΈ°λ¥ κµ¬ν„

---

## β… κµ¬ν„ λ‚΄μ©

### 1. **λ°μ΄ν„°λ² μ΄μ¤ ν•¨μ λ° λ·° μƒμ„±**

#### π“„ `database/create_element_id_search.sql`

**1) Element IDλ΅ μ„ΈνΈ κ²€μƒ‰ ν•¨μ**
```sql
CREATE OR REPLACE FUNCTION search_sets_by_element_id(p_element_id VARCHAR)
```
- Element IDλ¥Ό μ…λ ¥ν•λ©΄ ν•΄λ‹Ή λ¶€ν’μ΄ ν¬ν•¨λ λ¨λ“  μ„ΈνΈ λ°ν™
- μ„ΈνΈ μ •λ³΄ + λ¶€ν’ μ •λ³΄ + μƒ‰μƒ μ •λ³΄ ν¬ν•¨

**2) λ¶€ν’ λ²νΈ + μƒ‰μƒμΌλ΅ Element ID μ΅°ν ν•¨μ**
```sql
CREATE OR REPLACE FUNCTION get_element_ids_by_part_color(
  p_part_id VARCHAR,
  p_color_id INTEGER
)
```
- λ¶€ν’ λ²νΈμ™€ μƒ‰μƒ IDλ΅ ν•΄λ‹Ήν•λ” Element ID λ©λ΅ μ΅°ν

**3) ν†µν•© κ²€μƒ‰ ν•¨μ**
```sql
CREATE OR REPLACE FUNCTION universal_set_search(p_query VARCHAR)
```
- Element ID, μ„ΈνΈ λ²νΈ, μ„ΈνΈ μ΄λ¦„ λ¨λ‘ κ²€μƒ‰ κ°€λ¥
- μλ™μΌλ΅ κ²€μƒ‰ νƒ€μ… νλ³„ (element_id / set_search)

**4) Element ID κ²€μƒ‰ λ·°**
```sql
CREATE OR REPLACE VIEW v_element_id_search
```
- λΉ λ¥Έ μ΅°νλ¥Ό μ„ν• materialized view
- Element ID, λ¶€ν’ μ •λ³΄, μ„ΈνΈ μ •λ³΄ ν¬ν•¨

**5) μ„±λ¥ μµμ ν™” μΈλ±μ¤**
```sql
CREATE INDEX idx_set_parts_element_id ON set_parts(element_id) 
WHERE element_id IS NOT NULL;
```

---

### 2. **Composable κµ¬ν„**

#### π“„ `src/composables/useElementIdSearch.js`

**μ£Όμ” ν•¨μ:**

1. **`searchByElementId(elementId)`**
   - Element IDλ΅ μ„ΈνΈ κ²€μƒ‰
   - RPC ν•¨μ `search_sets_by_element_id` νΈμ¶

2. **`getElementIdsByPartColor(partId, colorId)`**
   - λ¶€ν’ λ²νΈ + μƒ‰μƒμΌλ΅ Element ID μ΅°ν
   - RPC ν•¨μ `get_element_ids_by_part_color` νΈμ¶

3. **`universalSearch(query)`**
   - ν†µν•© κ²€μƒ‰ (Element ID / μ„ΈνΈ λ²νΈ / μ„ΈνΈ μ΄λ¦„)
   - RPC ν•¨μ `universal_set_search` νΈμ¶
   - κ²€μƒ‰ νƒ€μ… μλ™ νλ³„

4. **`searchFromView(elementId)`**
   - λ·°μ—μ„ μ§μ ‘ μ΅°ν (λΉ λ¥Έ μ„±λ¥)

5. **`elementIdExists(elementId)`**
   - Element ID μ΅΄μ¬ μ—¬λ¶€ ν™•μΈ

---

### 3. **ν…μ¤νΈ νμ΄μ§€ κµ¬ν„**

#### π“„ `src/views/ElementIdSearchTest.vue`

**κΈ°λ¥:**

1. **ν†µν•© κ²€μƒ‰**
   - Element ID, μ„ΈνΈ λ²νΈ, μ„ΈνΈ μ΄λ¦„ μλ™ νλ³„
   - κ²€μƒ‰ νƒ€μ… ν‘μ‹ (Element ID / μ„ΈνΈ κ²€μƒ‰)
   - μΉ΄λ“ ν•μ‹μΌλ΅ κ²°κ³Ό ν‘μ‹

2. **Element ID μ „μ© κ²€μƒ‰**
   - Element IDλ§ μ…λ ¥
   - ν…μ΄λΈ” ν•μ‹μΌλ΅ μƒμ„Έ κ²°κ³Ό ν‘μ‹
   - μ„ΈνΈ μ •λ³΄ + λ¶€ν’ μ •λ³΄ + μƒ‰μƒ μ •λ³΄

3. **λ¶€ν’ λ²νΈ + μƒ‰μƒμΌλ΅ Element ID μ°ΎκΈ°**
   - λ¶€ν’ λ²νΈμ™€ μƒ‰μƒ ID μ…λ ¥
   - ν•΄λ‹Ήν•λ” Element ID λ©λ΅ ν‘μ‹
   - κ° Element IDκ°€ ν¬ν•¨λ μ„ΈνΈ μ •λ³΄

**UI νΉμ§•:**
- π¨ λ¨λν• λ””μμΈ (κ·ΈλΌλ°μ΄μ… λ²„νΌ, μΉ΄λ“ λ μ΄μ•„μ›ƒ)
- π“± λ°μ‘ν• λ””μμΈ
- π” μ‹¤μ‹κ°„ κ²€μƒ‰ (Enter ν‚¤ μ§€μ›)
- π’΅ κ²€μƒ‰ ννΈ μ κ³µ
- π–ΌοΈ μ„ΈνΈ μ΄λ―Έμ§€ ν‘μ‹ (WebP μ°μ„ )

---

### 4. **λΌμ°ν… λ° λ„¤λΉ„κ²μ΄μ…**

**μ¶”κ°€λ λΌμ°νΈ:**
```javascript
{ path: '/element-search', name: 'ElementIdSearchTest', component: ElementIdSearchTest }
```

**λ„¤λΉ„κ²μ΄μ… λ©”λ‰΄:**
```html
<router-link to="/element-search" class="nav-link">π” Element ID κ²€μƒ‰</router-link>
```

---

## π”§ μ‚¬μ© λ°©λ²•

### 1. **λ°μ΄ν„°λ² μ΄μ¤ μ„¤μ •**

Supabase SQL Editorμ—μ„ μ‹¤ν–‰:
```sql
-- database/create_element_id_search.sql νμΌ λ‚΄μ© μ „μ²΄ μ‹¤ν–‰
```

### 2. **μ›Ή νμ΄μ§€ μ ‘μ†**

```
http://localhost:3000/element-search
```

### 3. **κ²€μƒ‰ μμ **

**ν†µν•© κ²€μƒ‰:**
- `4500574` β†’ Element IDλ΅ κ²€μƒ‰
- `60315` β†’ μ„ΈνΈ λ²νΈλ΅ κ²€μƒ‰
- `City` β†’ μ„ΈνΈ μ΄λ¦„μΌλ΅ κ²€μƒ‰

**Element ID μ „μ© κ²€μƒ‰:**
- `4500574` μ…λ ¥ β†’ ν•΄λ‹Ή λ¶€ν’μ΄ ν¬ν•¨λ λ¨λ“  μ„ΈνΈ μ΅°ν

**λ¶€ν’ + μƒ‰μƒμΌλ΅ Element ID μ°ΎκΈ°:**
- λ¶€ν’ λ²νΈ: `3001`
- μƒ‰μƒ ID: `1`
- β†’ ν•΄λ‹Ή μ΅°ν•©μ Element ID λ©λ΅ μ΅°ν

---

## π“ κ²€μƒ‰ κ²°κ³Ό μ •λ³΄

### Element ID κ²€μƒ‰ μ‹ μ κ³µλλ” μ •λ³΄:

| ν•­λ© | μ„¤λ… |
|------|------|
| **μ„ΈνΈ μ •λ³΄** | μ„ΈνΈ λ²νΈ, μ΄λ¦„, μ—°λ„, λ¶€ν’ μ |
| **λ¶€ν’ μ •λ³΄** | λ¶€ν’ ID, λ¶€ν’ μ΄λ¦„ |
| **μƒ‰μƒ μ •λ³΄** | μƒ‰μƒ ID, μƒ‰μƒ μ΄λ¦„ |
| **μλ‰ μ •λ³΄** | ν•΄λ‹Ή λ¶€ν’μ μλ‰, μλΉ„ λ¶€ν’ μ—¬λ¶€ |
| **μ΄λ―Έμ§€** | μ„ΈνΈ μ΄λ―Έμ§€ (WebP μ°μ„ ) |

---

## π€ μ„±λ¥ μµμ ν™”

### 1. **μΈλ±μ¤ μµμ ν™”**
```sql
CREATE INDEX idx_set_parts_element_id ON set_parts(element_id) 
WHERE element_id IS NOT NULL;
```
- Element ID κ²€μƒ‰ μ†λ„ ν–¥μƒ
- NULL κ°’ μ μ™Έλ΅ μΈλ±μ¤ ν¬κΈ° μµμ†ν™”

### 2. **λ°°μΉ μ΅°ν**
- ν•λ²μ μΏΌλ¦¬λ΅ λ¨λ“  κ΄€λ ¨ μ •λ³΄ μ΅°ν
- JOINμ„ ν†µν•΄ μ„ΈνΈ, λ¶€ν’, μƒ‰μƒ μ •λ³΄ ν•λ²μ— κ°€μ Έμ¤κΈ°

### 3. **μΊμ‹± μ „λµ**
- Vue Composableμ reactive stateλ΅ κ²°κ³Ό μΊμ‹±
- μ¤‘λ³µ κ²€μƒ‰ μ‹ μ¦‰μ‹ κ²°κ³Ό ν‘μ‹

---

## π” κ²€μƒ‰ μ‹λ‚λ¦¬μ¤

### μ‹λ‚λ¦¬μ¤ 1: Element IDλ΅ μ„ΈνΈ μ°ΎκΈ°
**μƒν™©:** μ†μ— μλ” λ¶€ν’μ Element ID `4500574`λ¥Ό μ•κ³  μμ
**λ°©λ²•:** 
1. `/element-search` νμ΄μ§€ μ ‘μ†
2. ν†µν•© κ²€μƒ‰ λλ” Element ID μ „μ© κ²€μƒ‰μ— `4500574` μ…λ ¥
3. ν•΄λ‹Ή λ¶€ν’μ΄ ν¬ν•¨λ λ¨λ“  μ„ΈνΈ ν™•μΈ

### μ‹λ‚λ¦¬μ¤ 2: λ¶€ν’μΌλ΅ Element ID μ°ΎκΈ°
**μƒν™©:** λ¶€ν’ λ²νΈ `3001`κ³Ό μƒ‰μƒ `λΉ¨κ°•(1)`λ¥Ό μ•κ³  μμ
**λ°©λ²•:**
1. "λ¶€ν’ λ²νΈ + μƒ‰μƒμΌλ΅ Element ID μ°ΎκΈ°" μ„Ήμ… μ‚¬μ©
2. λ¶€ν’ λ²νΈ: `3001`, μƒ‰μƒ ID: `1` μ…λ ¥
3. ν•΄λ‹Ήν•λ” Element ID λ©λ΅ ν™•μΈ

### μ‹λ‚λ¦¬μ¤ 3: ν†µν•© κ²€μƒ‰
**μƒν™©:** Element IDμΈμ§€ μ„ΈνΈ λ²νΈμΈμ§€ ν™•μ‹¤ν•μ§€ μ•μ
**λ°©λ²•:**
1. ν†µν•© κ²€μƒ‰μ— μ«μ/ν…μ¤νΈ μ…λ ¥
2. μ‹μ¤ν…μ΄ μλ™μΌλ΅ νλ³„ν•μ—¬ κ²°κ³Ό μ κ³µ
3. κ²€μƒ‰ νƒ€μ… λ°°μ§€λ΅ μ–΄λ–¤ λ°©μ‹μΌλ΅ κ²€μƒ‰λμ—λ”μ§€ ν™•μΈ

---

## π― ν•µμ‹¬ κΈ°λ¥ μ •λ¦¬

### β… κµ¬ν„λ κΈ°λ¥

1. **Element ID κ²€μƒ‰**
   - β… Element IDλ΅ μ„ΈνΈ κ²€μƒ‰
   - β… λ¶€ν’ + μƒ‰μƒμΌλ΅ Element ID μ΅°ν
   - β… ν†µν•© κ²€μƒ‰ (μλ™ νλ³„)

2. **κ²€μƒ‰ κ²°κ³Ό**
   - β… μ„ΈνΈ μ •λ³΄ (λ²νΈ, μ΄λ¦„, μ—°λ„, λ¶€ν’ μ)
   - β… λ¶€ν’ μ •λ³΄ (ID, μ΄λ¦„)
   - β… μƒ‰μƒ μ •λ³΄ (ID, μ΄λ¦„)
   - β… μλ‰ λ° μλΉ„ λ¶€ν’ ν‘μ‹
   - β… μ„ΈνΈ μ΄λ―Έμ§€ ν‘μ‹

3. **UI/UX**
   - β… 3κ°€μ§€ κ²€μƒ‰ λ°©μ‹ μ κ³µ
   - β… κ²€μƒ‰ ννΈ λ° μμ 
   - β… μΉ΄λ“/ν…μ΄λΈ” ν•μ‹ κ²°κ³Ό ν‘μ‹
   - β… μ—λ¬ μ²λ¦¬ λ° λΉ κ²°κ³Ό μ•λ‚΄
   - β… λ΅λ”© μƒνƒ ν‘μ‹

4. **μ„±λ¥**
   - β… μΈλ±μ¤ μµμ ν™”
   - β… λ°°μΉ μΏΌλ¦¬
   - β… κ²°κ³Ό μΊμ‹±

---

## π“ μ¶”ν›„ κ°μ„  κ°€λ¥ μ‚¬ν•­

1. **κ²€μƒ‰ κΈ°λ΅ μ €μ¥**
   - LocalStorageμ— κ²€μƒ‰ κΈ°λ΅ μ €μ¥
   - μµκ·Ό κ²€μƒ‰μ–΄ μλ™ μ™„μ„±

2. **λ¶€ν’ μƒμ„Έ μ •λ³΄ λ¨λ‹¬**
   - κ²€μƒ‰ κ²°κ³Ό ν΄λ¦­ μ‹ μƒμ„Έ μ •λ³΄ ν‘μ‹
   - λ¶€ν’ 3D λ·° (κ°€λ¥ν• κ²½μ°)

3. **λ€λ‰ κ²€μƒ‰**
   - CSV νμΌ μ—…λ΅λ“
   - μ—¬λ¬ Element ID μΌκ΄„ κ²€μƒ‰

4. **Export κΈ°λ¥**
   - κ²€μƒ‰ κ²°κ³Ό CSV/JSON λ‹¤μ΄λ΅λ“
   - ν”„λ¦°νΈ μµμ ν™” λ·°

---

## β… ν…μ¤νΈ μ²΄ν¬λ¦¬μ¤νΈ

- [x] Element IDλ΅ μ„ΈνΈ κ²€μƒ‰
- [x] λ¶€ν’ + μƒ‰μƒμΌλ΅ Element ID μ΅°ν
- [x] ν†µν•© κ²€μƒ‰ (Element ID)
- [x] ν†µν•© κ²€μƒ‰ (μ„ΈνΈ λ²νΈ)
- [x] ν†µν•© κ²€μƒ‰ (μ„ΈνΈ μ΄λ¦„)
- [x] κ²€μƒ‰ κ²°κ³Ό μΉ΄λ“ ν‘μ‹
- [x] κ²€μƒ‰ κ²°κ³Ό ν…μ΄λΈ” ν‘μ‹
- [x] λΉ κ²°κ³Ό μ²λ¦¬
- [x] μ—λ¬ μ²λ¦¬
- [x] λ΅λ”© μƒνƒ
- [x] μ΄λ―Έμ§€ ν΄λ°±
- [x] λ°μ‘ν• λ””μμΈ

---

## π‰ κ²°λ΅ 

**Element ID κ²€μƒ‰ κΈ°λ¥μ΄ μ™„λ²½ν•κ² κµ¬ν„λμ—μµλ‹λ‹¤!**

μ΄μ  μ‚¬μ©μλ”:
1. β… Element IDλ΅ ν•΄λ‹Ή λ¶€ν’μ΄ ν¬ν•¨λ μ„ΈνΈλ¥Ό κ²€μƒ‰ν•  μ μμµλ‹λ‹¤
2. β… λ¶€ν’ λ²νΈμ™€ μƒ‰μƒμΌλ΅ Element IDλ¥Ό μ°Ύμ„ μ μμµλ‹λ‹¤
3. β… ν†µν•© κ²€μƒ‰μΌλ΅ νΈλ¦¬ν•κ² κ²€μƒ‰ν•  μ μμµλ‹λ‹¤

**μ ‘μ† URL:** http://localhost:3000/element-search

